<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function fits a Variable Length Markov Chain with Covariates (coVLMC) to
a discrete time series coupled with a time series of covariates by optimizing
an information criterion (BIC or AIC)."><title>Fit an optimal Variable Length Markov Chain with Covariates (coVLMC) — tune_covlmc • mixvlmc</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fit an optimal Variable Length Markov Chain with Covariates (coVLMC) — tune_covlmc"><meta property="og:description" content="This function fits a Variable Length Markov Chain with Covariates (coVLMC) to
a discrete time series coupled with a time series of covariates by optimizing
an information criterion (BIC or AIC)."><meta name="robots" content="noindex"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">mixvlmc</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.2.1.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Getting started</h6>
    <a class="dropdown-item" href="../articles/context-trees.html">Context trees</a>
    <a class="dropdown-item" href="../articles/variable-length-markov-chains.html">Variable length Markov chains (VLMC)</a>
    <a class="dropdown-item" href="../articles/covlmc.html">Variable Length Markov Chains with Covariates (COVLMC)</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Advanced topics</h6>
    <a class="dropdown-item" href="../articles/likelihood.html">Likelihood calculation</a>
    <a class="dropdown-item" href="../articles/prediction.html">Predicting with (CO)VLMC</a>
    <a class="dropdown-item" href="../articles/sampling.html">Sampling from (CO)VLMC</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/index.html">More articles...</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-news">News</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-news">
    <h6 class="dropdown-header" data-toc-skip>Releases</h6>
    <a class="external-link dropdown-item" href="https://fabrice-rossi.github.io/blog/posts/mixvlmc-0-2.html">mixvlmc 0.2.0</a>
    <a class="external-link dropdown-item" href="https://fabrice-rossi.github.io/blog/posts/mixvlmc-0-1.html">mixvlmc 0.1.1</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../news/index.html">Changelog</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/fabrice-rossi/mixvlmc/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Fit an optimal Variable Length Markov Chain with Covariates (coVLMC)</h1>
      <small class="dont-index">Source: <a href="https://github.com/fabrice-rossi/mixvlmc/blob/HEAD/R/covlmc_tune.R" class="external-link"><code>R/covlmc_tune.R</code></a></small>
      <div class="d-none name"><code>tune_covlmc.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function fits a Variable Length Markov Chain with Covariates (coVLMC) to
a discrete time series coupled with a time series of covariates by optimizing
an information criterion (BIC or AIC).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">tune_covlmc</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">covariate</span>,</span>
<span>  criterion <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BIC"</span>, <span class="st">"AIC"</span><span class="op">)</span>,</span>
<span>  initial <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"truncated"</span>, <span class="st">"specific"</span>, <span class="st">"extended"</span><span class="op">)</span>,</span>
<span>  alpha_init <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  min_size <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  max_depth <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  verbose <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  save <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"best"</span>, <span class="st">"initial"</span>, <span class="st">"all"</span><span class="op">)</span>,</span>
<span>  trimming <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"full"</span>, <span class="st">"partial"</span>, <span class="st">"none"</span><span class="op">)</span>,</span>
<span>  best_trimming <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"partial"</span>, <span class="st">"full"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>a discrete time series; can be numeric, character, factor and
logical.</p></dd>


<dt>covariate</dt>
<dd><p>a data frame of covariates.</p></dd>


<dt>criterion</dt>
<dd><p>criterion used to select the best model. Either <code>"BIC"</code>
(default) or <code>"AIC"</code> (see details).</p></dd>


<dt>initial</dt>
<dd><p>specifies the likelihood function, more precisely the way the
first few observations for which contexts cannot be calculated are
integrated in the likelihood. See <code><a href="loglikelihood.html">loglikelihood()</a></code> for details.</p></dd>


<dt>alpha_init</dt>
<dd><p>if non <code>NULL</code> used as the initial cut off parameter (in
quantile scale) to build the initial VLMC</p></dd>


<dt>min_size</dt>
<dd><p>integer &gt;= 1 (default: 5). Tune the minimum number of
observations for a context in the growing phase of the context tree (see
<code><a href="covlmc.html">covlmc()</a></code> for details).</p></dd>


<dt>max_depth</dt>
<dd><p>integer &gt;= 1 (default: 100). Longest context considered in
growing phase of the initial context tree (see details).</p></dd>


<dt>verbose</dt>
<dd><p>integer &gt;= 0 (default: 0). Verbosity level of the pruning
process.</p></dd>


<dt>save</dt>
<dd><p>specify which BIC models are saved during the pruning process.
The default value <code>"best"</code> asks the function to keep only the best model
according to the <code>criterion</code>. When <code>save="initial"</code> the function keeps <em>in
addition</em> the initial (complex) model which is then pruned during the
selection process. When <code>save="all"</code>, the function returns all the models
considered during the selection process. See details for memory occupation.</p></dd>


<dt>trimming</dt>
<dd><p>specify the type of trimming used when saving the
intermediate models, see details.</p></dd>


<dt>best_trimming</dt>
<dd><p>specify the type of trimming used when saving the best
model and the initial one (see details).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>a list with the following components:</p><ul><li><p><code>best_model</code>: the optimal COVLMC</p></li>
<li><p><code>criterion</code>: the criterion used to select the optimal VLMC</p></li>
<li><p><code>initial</code>: the likelihood function used to select the optimal VLMC</p></li>
<li><p><code>results</code>: a data frame with details about the pruning process</p></li>
<li><p><code>saved_models</code>: a list of intermediate COVLMCs if <code>save="initial"</code> or
<code>save="all"</code>. It contains an <code>initial</code> component with the large coVLMC
obtained first and an <code>all</code> component with a list of all the <em>other</em> coVLMC
obtained by pruning the initial one.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function automates the process of fitting a large coVLMC to a discrete
time series with <code><a href="covlmc.html">covlmc()</a></code> and of pruning the tree (with <code><a href="cutoff.html">cutoff()</a></code> and
<code><a href="prune.html">prune()</a></code>) to get an optimal with respect to an information criterion. To
avoid missing long term dependencies, the function uses the <code>max_depth</code>
parameter as an initial guess but then relies on an automatic increase of the
value to make sure the initial context tree is only limited by the <code>min_size</code>
parameter. The initial value of the <code>alpha</code> parameter of <code><a href="covlmc.html">covlmc()</a></code> is also
set to a conservative value (0.5) to avoid prior simplification of the
context tree. This can be overridden by setting the <code>alpha_init</code> parameter to
a more adapted value.</p>
<p>Once the initial coVLMC is obtained, the <code><a href="cutoff.html">cutoff()</a></code> and <code><a href="prune.html">prune()</a></code> functions
are used to build all the coVLMC models that could be generated using smaller
values of the alpha parameter. The best model is selected from this
collection, including the initial complex tree, as the one that minimizes the
chosen information criterion.</p>
    </div>
    <div class="section level2">
    <h2 id="memory-occupation">Memory occupation<a class="anchor" aria-label="anchor" href="#memory-occupation"></a></h2>
    


<p><code>covlmc</code> objects tend to be large and saving all the models during the
search for the optimal model can lead to an unreasonable use of memory. To
avoid this problem, models are kept in trimmed form only using
<code><a href="trim.covlmc.html">trim.covlmc()</a></code> with <code>keep_model=FALSE</code>. Both the initial model and the
best one are saved untrimmed. This default behaviour corresponds to
<code>trimming="full"</code>. Setting <code>trimming="partial"</code> asks the function to use
<code>keep_model=TRUE</code> in <code><a href="trim.covlmc.html">trim.covlmc()</a></code> for intermediate models. Finally,
<code>trimming="none"</code> turns off trimming, which is discouraged expected for
small data sets.</p>
<p>In parallel processing contexts (e.g. using <a href="https://rdrr.io/pkg/foreach/man/foreach.html" class="external-link">foreach::%dopar%</a>), the memory
occupation of the results can become very large as models tend to keep
environments attached to the formulas. In this situation, it is highly
recommended to trim all saved models, including the best one and the
initial one. This can be done via the <code>best_trimming</code> parameter whose
possible values are identical to the ones of <code>trimming</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="covlmc.html">covlmc()</a></code>, <code><a href="cutoff.html">cutoff()</a></code> and <code><a href="prune.html">prune()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">pc</span> <span class="op">&lt;-</span> <span class="va">powerconsumption</span><span class="op">[</span><span class="va">powerconsumption</span><span class="op">$</span><span class="va">week</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fl">6</span><span class="op">:</span><span class="fl">7</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">dts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">pc</span><span class="op">$</span><span class="va">active_power</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">pc</span><span class="op">$</span><span class="va">active_power</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dts_cov</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>day_night <span class="op">=</span> <span class="op">(</span><span class="va">pc</span><span class="op">$</span><span class="va">hour</span> <span class="op">&gt;=</span> <span class="fl">7</span> <span class="op">&amp;</span> <span class="va">pc</span><span class="op">$</span><span class="va">hour</span> <span class="op">&lt;=</span> <span class="fl">17</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dts_best_model_tune</span> <span class="op">&lt;-</span> <span class="fu">tune_covlmc</span><span class="op">(</span><span class="va">dts</span>, <span class="va">dts_cov</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="draw.html">draw</a></span><span class="op">(</span><span class="fu"><a href="as_covlmc.html">as_covlmc</a></span><span class="op">(</span><span class="va">dts_best_model_tune</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +-- (0,1.26]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |   +-- (0,1.26] (0.931, 0.06897)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |   '-- (1.26,6.48] (0.8205, 0.1795)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> '-- (1.26,6.48]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     +-- (0,1.26] (0.1538, 0.8462)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     '-- (1.26,6.48]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         +-- (0,1.26] (0.1667, 0.8333)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         '-- (1.26,6.48]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             +-- (0,1.26] ([ 0.47 &amp; 2.862 ])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             '-- (1.26,6.48] (0.05439, 0.9456)</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by <a href="https://fabrice-rossi.github.io/" class="external-link">Fabrice Rossi</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

