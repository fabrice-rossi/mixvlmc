<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Estimates Variable Length Markov Chains (VLMC) models and VLMC with 
    covariates models from discrete sequences. Supports model selection via
    information criteria and simulation of new sequences from an estimated
    model. See Bühlmann, P. and Wyner, A. J. (1999) &lt;doi:10.1214/aos/1018031204&gt; 
    for VLMC and Zanin Zambom, A., Kim, S. and Lopes Garcia, N. (2022) 
    &lt;doi:10.1111/jtsa.12615&gt; for VLMC with covariates.">
<title>Variable Length Markov Chains with Covariates • mixvlmc</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Variable Length Markov Chains with Covariates">
<meta property="og:description" content="Estimates Variable Length Markov Chains (VLMC) models and VLMC with 
    covariates models from discrete sequences. Supports model selection via
    information criteria and simulation of new sequences from an estimated
    model. See Bühlmann, P. and Wyner, A. J. (1999) &lt;doi:10.1214/aos/1018031204&gt; 
    for VLMC and Zanin Zambom, A., Kim, S. and Lopes Garcia, N. (2022) 
    &lt;doi:10.1111/jtsa.12615&gt; for VLMC with covariates.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">mixvlmc</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/context-trees.html">Context trees</a>
    <a class="dropdown-item" href="articles/covlmc.html">Variable Length Markov Chains with Covariates (COVLMC)</a>
    <a class="dropdown-item" href="articles/sampling.html">Sampling from (CO)VLMC</a>
    <a class="dropdown-item" href="articles/variable-length-markov-chains.html">Variable length Markov chains (VLMC)</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/fabrice-rossi/mixvlmc/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="variable-length-markov-chains-with-covariates">Variable Length Markov Chains with Covariates<a class="anchor" aria-label="anchor" href="#variable-length-markov-chains-with-covariates"></a>
</h1></div>
<!-- badges: start -->

<!-- badges: end -->
<p><code>mixvlmc</code> implements variable length Markov chains (VLMC) and variable length Markov chains with covariates (COVLMC), as described in:</p>
<ul>
<li><a href="https://dx.doi.org/10.1214/aos/1018031204" class="external-link">Bühlmann, P. and Wyner, A. J. (1999), Variable length Markov chains. Ann. Statist. 27 (2) 480-513</a></li>
<li><a href="https://doi.org/10.1111/jtsa.12615" class="external-link">Zanin Zambom, A., Kim, S. and Lopes Garcia, N. (2022), Variable length Markov chain with exogenous covariates. J. Time Ser. Anal., 43 (2) 312-328</a></li>
</ul>
<p><code>mixvlmc</code> includes functionalities similar to the ones available in <a href="https://cran.r-project.org/package=VLMC" class="external-link">VLMC</a> and <a href="https://cran.r-project.org/package=PST" class="external-link">PST</a>. The main advantages of <code>mixvlmc</code> are the support of time varying covariates with COVLMC and the introduction of post-pruning of the models that enables fast model selection via information criteria.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>The package can be installed from CRAN with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"mixvlmc"</span><span class="op">)</span></span></code></pre></div>
<p>The development version is available from GitHub:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"fabrice-rossi/mixvlmc"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<div class="section level3">
<h3 id="variable-length-markov-chains">Variable length Markov chains<a class="anchor" aria-label="anchor" href="#variable-length-markov-chains"></a>
</h3>
<p>Variable length Markov chains (VLMC) are sparse high order Markov chains. They can be used to model time series (sequences) with discrete values (states) with a mix of small order dependencies for certain states and higher order dependencies for other states. For instance, with a binary time series, the probability of observing 1 at time <span class="math inline"><em>t</em></span> could be constant whatever the older past states if the last one (at time <span class="math inline"><em>t</em> − 1</span>) was 1, but could depend on states at time <span class="math inline"><em>t</em> − 3</span> and <span class="math inline"><em>t</em> − 2</span> if the state was 0 at time <span class="math inline"><em>t</em> − 1</span>. A collection of past states that determines completely the transition probabilities is a <em>context</em> of the VLMC. Read <code><a href="articles/context-trees.html">vignette("context-trees")</a></code> for details about contexts and context tree, and see <code><a href="articles/variable-length-markov-chains.html">vignette("variable-length-markov-chains")</a></code> for a more detailed introduction to VLMC.</p>
<p>VLMC with covariates (COVLMC) are extension of VLMC in which transition probabilities (probabilities of the next state given the past) can be influenced by the past values of some covariates (in addition to the past values of the time series itself). Each context is associated to a logistic model that maps the (past values of the) covariates to transition probabilities.</p>
</div>
<div class="section level3">
<h3 id="fitting-a-vlmc">Fitting a VLMC<a class="anchor" aria-label="anchor" href="#fitting-a-vlmc"></a>
</h3>
<p>The package is loaded in a standard way.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/fabrice-rossi/mixvlmc" class="external-link">mixvlmc</a></span><span class="op">)</span></span>
<span><span class="co">## we use ggplot2 for graphics but this is not a dependency of the package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<p>The main function of VLMC is <code><a href="reference/vlmc.html">vlmc()</a></code> which can be called on a time series represented by a numerical vector or a factor, for instance.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0L</span>, <span class="fl">1L</span><span class="op">)</span>, <span class="fl">200</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/vlmc.html">vlmc</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="va">model</span></span>
<span><span class="co">#&gt; VLMC context tree on 0, 1 </span></span>
<span><span class="co">#&gt;  cutoff: 1.921 (quantile: 0.05)</span></span>
<span><span class="co">#&gt;  Number of contexts: 11 </span></span>
<span><span class="co">#&gt;  Maximum context length: 6</span></span></code></pre></div>
<p>The default parameters of <code><a href="reference/vlmc.html">vlmc()</a></code> will tend to produce overly complex VLMC in order to avoid missing potential structure in the time series. In the example above, we expect the optimal VLMC to be a constant distribution as the sample is independent and uniformly distributed (it has no temporal structure). The default parameters give here an overly complex model, as illustrated by its text based representation</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/draw.html">draw</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="co">#&gt; * (0.505, 0.495)</span></span>
<span><span class="co">#&gt; '-- 1 (0.4848, 0.5152)</span></span>
<span><span class="co">#&gt;     +-- 0 (0.5319, 0.4681)</span></span>
<span><span class="co">#&gt;     |   '-- 1 (0.5, 0.5)</span></span>
<span><span class="co">#&gt;     |       '-- 0 (0.4444, 0.5556)</span></span>
<span><span class="co">#&gt;     |           '-- 0 (0.4286, 0.5714)</span></span>
<span><span class="co">#&gt;     |               +-- 0 (1, 0)</span></span>
<span><span class="co">#&gt;     |               '-- 1 (0, 1)</span></span>
<span><span class="co">#&gt;     '-- 1 (0.4314, 0.5686)</span></span>
<span><span class="co">#&gt;         '-- 0 (0.2727, 0.7273)</span></span>
<span><span class="co">#&gt;             '-- 0 (0.3846, 0.6154)</span></span>
<span><span class="co">#&gt;                 '-- 0 (0.5, 0.5)</span></span>
<span><span class="co">#&gt;                     +-- 0 (0, 1)</span></span>
<span><span class="co">#&gt;                     '-- 1 (1, 0)</span></span></code></pre></div>
<p>The representation uses simple ASCII art to display the contexts of the VLMC organized into a tree (see <code><a href="articles/context-trees.html">vignette("context-trees")</a></code> for a more detailed introduction):</p>
<ul>
<li>the root <code>*</code> corresponds to an empty context;</li>
<li>one can read contexts by following branches (represented by 2 dashes <code>--</code>) down to their ends (the leaves): for instance <span class="math inline">(1,0,1,0,0,0)</span> is one of the contexts of the tree.</li>
</ul>
<p>Here the context <span class="math inline">(1,0,1,0,0,0)</span> is associated to the transition probabilities <span class="math inline">(1,0)</span>. This means that when one observes this context in the time series, it is <em>always</em> followed by a 0. Notice that contexts are traditionally written from the most recent value to the oldest one. Thus, the context <span class="math inline">(1,0,1,0,0,0)</span> corresponds to the sub time series <span class="math inline">(0,0,0,1,0,1)</span>.</p>
<div class="section level4">
<h4 id="bic-based-model-selection">BIC based model selection<a class="anchor" aria-label="anchor" href="#bic-based-model-selection"></a>
</h4>
<p>The VLMC above is obviously overfitting to the time series, as illustrated by the 0/1 transition probabilities. A classical way to select a good model is to minimize the <a href="https://en.wikipedia.org/wiki/Bayesian_information_criterion" class="external-link">BIC</a>. In <code>mixvlmc</code> this can be done easily using using ‘tune_vlmc()’ which fits first a complex VLMC and then <em>prunes</em> it (using a combination of <code><a href="reference/cutoff.html">cutoff()</a></code> and <code><a href="reference/prune.html">prune()</a></code>), as follows (see <code><a href="articles/variable-length-markov-chains.html">vignette("variable-length-markov-chains")</a></code> for details):</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">best_model_tune</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/tune_vlmc.html">tune_vlmc</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="va">best_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/as_vlmc.html">as_vlmc</a></span><span class="op">(</span><span class="va">best_model_tune</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/draw.html">draw</a></span><span class="op">(</span><span class="va">best_model</span><span class="op">)</span></span>
<span><span class="co">#&gt; * (0.505, 0.495)</span></span></code></pre></div>
<p>As expected, we end up with a constant model.</p>
<p>In time series with actual temporal patterns, the optimal model will be more complex. As a very basic illustrative example, let us consider the <code>sunspot.year</code> time series and turn it into a binary one, with high activity associated to a number of sun spots larger than the median number.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sun_activity</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">sunspot.year</span> <span class="op">&gt;=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">sunspot.year</span><span class="op">)</span>, <span class="st">"high"</span>, <span class="st">"low"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>We adjust automatically an optimal VLMC as follows:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sun_model_tune</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/tune_vlmc.html">tune_vlmc</a></span><span class="op">(</span><span class="va">sun_activity</span><span class="op">)</span></span>
<span><span class="va">sun_model_tune</span></span>
<span><span class="co">#&gt; VLMC context tree on high, low </span></span>
<span><span class="co">#&gt;  cutoff: 3.481 (quantile: 0.0083243263138364)</span></span>
<span><span class="co">#&gt;  Number of contexts: 9 </span></span>
<span><span class="co">#&gt;  Maximum context length: 5 </span></span>
<span><span class="co">#&gt;  Selected by BIC (244.0594)</span></span></code></pre></div>
<p>The results of the pruning process can be represented graphically:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">sun_model_tune</span><span class="op">$</span><span class="va">results</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">alpha</span>, y <span class="op">=</span> <span class="va">BIC</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-sunspots_bic-1.png" width="100%"></p>
<p>The plot shows that simpler models are too simple as the BIC increases when pruning becomes strong enough. The best model remains rather complex (as expected based on the periodicity of the Solar cycle):</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">best_sun_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/as_vlmc.html">as_vlmc</a></span><span class="op">(</span><span class="va">sun_model_tune</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/draw.html">draw</a></span><span class="op">(</span><span class="va">best_sun_model</span><span class="op">)</span></span>
<span><span class="co">#&gt; * (0.5052, 0.4948)</span></span>
<span><span class="co">#&gt; +-- high (0.8207, 0.1793)</span></span>
<span><span class="co">#&gt; |   '-- high (0.7899, 0.2101)</span></span>
<span><span class="co">#&gt; |       '-- high (0.7447, 0.2553)</span></span>
<span><span class="co">#&gt; |           +-- high (0.6571, 0.3429)</span></span>
<span><span class="co">#&gt; |           |   '-- low (0.9167, 0.08333)</span></span>
<span><span class="co">#&gt; |           '-- low (1, 0)</span></span>
<span><span class="co">#&gt; '-- low (0.1888, 0.8112)</span></span>
<span><span class="co">#&gt;     +-- high (0, 1)</span></span>
<span><span class="co">#&gt;     '-- low (0.2328, 0.7672)</span></span>
<span><span class="co">#&gt;         +-- high (0, 1)</span></span>
<span><span class="co">#&gt;         '-- low (0.3034, 0.6966)</span></span>
<span><span class="co">#&gt;             '-- high (0.07692, 0.9231)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="fitting-a-vlmc-with-covariates">Fitting a VLMC with covariates<a class="anchor" aria-label="anchor" href="#fitting-a-vlmc-with-covariates"></a>
</h3>
<p>To illustrate the use of covariates, we use the power consumption data set included in the package (see <code><a href="articles/covlmc.html">vignette("covlmc")</a></code> for details). We consider a week of electricity usage as follows:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pc_week_5</span> <span class="op">&lt;-</span> <span class="va">powerconsumption</span><span class="op">[</span><span class="va">powerconsumption</span><span class="op">$</span><span class="va">week</span> <span class="op">==</span> <span class="fl">5</span>, <span class="op">]</span></span>
<span><span class="va">elec</span> <span class="op">&lt;-</span> <span class="va">pc_week_5</span><span class="op">$</span><span class="va">active_power</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">pc_week_5</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date_time</span>, y <span class="op">=</span> <span class="va">active_power</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Date"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Activer power (kW)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-active_power_week_5-1.png" width="100%"></p>
<p>The time series displays some typical patterns of electricity usage:</p>
<ul>
<li>low active power at night (typically below 0.4 kW);</li>
<li>standard use between 0.4 and 2 kW;</li>
<li>peak use above 2 kW.</li>
</ul>
<p>We build a discrete time series from those (somewhat arbitrary) thresholds:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">elec_dts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">elec</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.4</span>, <span class="fl">2</span>, <span class="fl">8</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"low"</span>, <span class="st">"typical"</span>, <span class="st">"high"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The best VLMC model is quite simple. It is almost a standard order one Markov chain, up to the order 2 context used when the active power is <em>typical</em>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">elec_vlmc_tune</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/tune_vlmc.html">tune_vlmc</a></span><span class="op">(</span><span class="va">elec_dts</span><span class="op">)</span></span>
<span><span class="va">best_elec_vlmc</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/as_vlmc.html">as_vlmc</a></span><span class="op">(</span><span class="va">elec_vlmc_tune</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/draw.html">draw</a></span><span class="op">(</span><span class="va">best_elec_vlmc</span><span class="op">)</span></span>
<span><span class="co">#&gt; * (0.1667, 0.5496, 0.2837)</span></span>
<span><span class="co">#&gt; +-- low (0.7665, 0.2335, 0)</span></span>
<span><span class="co">#&gt; '-- typical (0.0704, 0.8466, 0.08303)</span></span>
<span><span class="co">#&gt; |   '-- low (0.3846, 0.5385, 0.07692)</span></span>
<span><span class="co">#&gt; '-- high (0.003497, 0.1573, 0.8392)</span></span></code></pre></div>
<p>As pointed about above, <em>low</em> active power tend to correspond to night phase. We can include this information by introducing a day covariate as follows:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">elec_cov</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>day <span class="op">=</span> <span class="op">(</span><span class="va">pc_week_5</span><span class="op">$</span><span class="va">hour</span> <span class="op">&gt;=</span> <span class="fl">7</span> <span class="op">&amp;</span> <span class="va">pc_week_5</span><span class="op">$</span><span class="va">hour</span> <span class="op">&lt;=</span> <span class="fl">17</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>A COVLMC is estimated using the <code>covlmc</code> function:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">elec_covlmc</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/covlmc.html">covlmc</a></span><span class="op">(</span><span class="va">elec_dts</span>, <span class="va">elec_cov</span>, min_size <span class="op">=</span> <span class="fl">2</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/draw.html">draw</a></span><span class="op">(</span><span class="va">elec_covlmc</span>, time_sep <span class="op">=</span> <span class="st">" | "</span>, model <span class="op">=</span> <span class="st">"full"</span>, p_value <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; *</span></span>
<span><span class="co">#&gt; +-- low ([ (I)    | day_1TRUE</span></span>
<span><span class="co">#&gt; |          -1.558 | 1.006     ])</span></span>
<span><span class="co">#&gt; '-- typical</span></span>
<span><span class="co">#&gt; |   +-- low ([ (I)    | day_1TRUE | day_2TRUE</span></span>
<span><span class="co">#&gt; |   |          0.3567 | -27.81    | 27.81    </span></span>
<span><span class="co">#&gt; |   |          -1.253 | -14.39    | 13.69     ])</span></span>
<span><span class="co">#&gt; |   '-- typical ([ (I)    | day_1TRUE</span></span>
<span><span class="co">#&gt; |   |              2.666  | 0.566    </span></span>
<span><span class="co">#&gt; |   |              0.2683 | 0.2426    ])</span></span>
<span><span class="co">#&gt; |   '-- high ([ (I)    | day_1TRUE</span></span>
<span><span class="co">#&gt; |               2.015  | 16.18    </span></span>
<span><span class="co">#&gt; |               0.6931 | 16.61     ])</span></span>
<span><span class="co">#&gt; '-- high ([ (I)   | day_1TRUE</span></span>
<span><span class="co">#&gt;             17.41 | -14.23   </span></span>
<span><span class="co">#&gt;             19.38 | -14.88    ])</span></span></code></pre></div>
<p>The model appears a bit complex. To get a more adapted model, we use a BIC based model selection as follows:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">elec_covlmc_tune</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/tune_covlmc.html">tune_covlmc</a></span><span class="op">(</span><span class="va">elec_dts</span>, <span class="va">elec_cov</span><span class="op">)</span></span>
<span><span class="va">best_elec_covlmc</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/as_covlmc.html">as_covlmc</a></span><span class="op">(</span><span class="va">elec_covlmc_tune</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/draw.html">draw</a></span><span class="op">(</span><span class="va">best_elec_covlmc</span>, model <span class="op">=</span> <span class="st">"full"</span>, time_sep <span class="op">=</span> <span class="st">" | "</span>, p_value <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; *</span></span>
<span><span class="co">#&gt; +-- low ([ (I)    | day_1TRUE</span></span>
<span><span class="co">#&gt; |          -1.558 | 1.006     ])</span></span>
<span><span class="co">#&gt; '-- typical</span></span>
<span><span class="co">#&gt; |   +-- low ([ (I)   </span></span>
<span><span class="co">#&gt; |   |          0.3365</span></span>
<span><span class="co">#&gt; |   |          -1.609 ])</span></span>
<span><span class="co">#&gt; |   '-- typical ([ (I)   </span></span>
<span><span class="co">#&gt; |   |              2.937 </span></span>
<span><span class="co">#&gt; |   |              0.3747 ])</span></span>
<span><span class="co">#&gt; |   '-- high ([ (I)  </span></span>
<span><span class="co">#&gt; |               2.773</span></span>
<span><span class="co">#&gt; |               1.705 ])</span></span>
<span><span class="co">#&gt; '-- high ([ (I)  </span></span>
<span><span class="co">#&gt;             3.807</span></span>
<span><span class="co">#&gt;             5.481 ])</span></span></code></pre></div>
<p>As in the VLMC case, the optimal model remains rather simple:</p>
<ul>
<li>the <em>high</em> context do not use the covariate and is equivalent to the vlmc context;</li>
<li>the <em>low</em> context is more interesting: it does not switch to a <em>high</em> context (hence the single row of parameters) but uses the covariate. As expected, the probability of switching from <em>low</em> to <em>typical</em> is larger during the day;</li>
<li>the <em>typical</em> context is described in a more complex way that in the case of the vlmc as the transition probabilities depend on the previous state.</li>
</ul>
</div>
<div class="section level3">
<h3 id="sampling">Sampling<a class="anchor" aria-label="anchor" href="#sampling"></a>
</h3>
<p>VLMC models can also be used to sample new time series as in the VMLC bootstrap proposed by Bühlmann and Wyner. For instance, we can estimate the longest time period spent in the <em>high</em> active power regime. In this “predictive” setting, the <a href="https://en.wikipedia.org/wiki/Akaike_information_criterion" class="external-link">AIC</a> may be more adapted to select the best model. Notice that some quantities can be computed directly from the model in the VLMC case, using classical results on Markov Chains. See <code><a href="articles/sampling.html">vignette("sampling")</a></code> for details on sampling.</p>
<p>We first select two models based on the AIC.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">best_elec_vlmc_aic</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/as_vlmc.html">as_vlmc</a></span><span class="op">(</span><span class="fu"><a href="reference/tune_vlmc.html">tune_vlmc</a></span><span class="op">(</span><span class="va">elec_dts</span>, criterion <span class="op">=</span> <span class="st">"AIC"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">best_elec_covlmc_aic</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/as_covlmc.html">as_covlmc</a></span><span class="op">(</span><span class="fu"><a href="reference/tune_covlmc.html">tune_covlmc</a></span><span class="op">(</span><span class="va">elec_dts</span>, <span class="va">elec_cov</span>, criterion <span class="op">=</span> <span class="st">"AIC"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The we sample 100 new time series for each model, using the <code><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate()</a></code> function as follows:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">vlmc_simul</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span>mode <span class="op">=</span> <span class="st">"list"</span>, <span class="fl">100</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">vlmc_simul</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">vlmc_simul</span><span class="op">[[</span><span class="va">k</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate</a></span><span class="op">(</span><span class="va">best_elec_vlmc_aic</span>, nsim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">elec_dts</span><span class="op">)</span>, init <span class="op">=</span> <span class="va">elec_dts</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">covlmc_simul</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span>mode <span class="op">=</span> <span class="st">"list"</span>, <span class="fl">100</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">covlmc_simul</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">covlmc_simul</span><span class="op">[[</span><span class="va">k</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate</a></span><span class="op">(</span><span class="va">best_elec_covlmc_aic</span>, nsim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">elec_dts</span><span class="op">)</span>, covariate <span class="op">=</span> <span class="va">elec_cov</span>, init <span class="op">=</span> <span class="va">elec_dts</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Then statistics can be computed on those time series. For instance, we look for the longest time period spent in the <em>high</em> active power regime.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">longuest_high</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">high_length</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rle.html" class="external-link">rle</a></span><span class="op">(</span><span class="va">x</span> <span class="op">==</span> <span class="st">"high"</span><span class="op">)</span></span>
<span>  <span class="fl">10</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">high_length</span><span class="op">$</span><span class="va">lengths</span><span class="op">[</span><span class="va">high_length</span><span class="op">$</span><span class="va">values</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">lh_vlmc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">vlmc_simul</span>, <span class="va">longuest_high</span><span class="op">)</span></span>
<span><span class="va">lh_covlmc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">covlmc_simul</span>, <span class="va">longuest_high</span><span class="op">)</span></span></code></pre></div>
<p>The average longest time spent in <em>high</em> consecutively is</p>
<ul>
<li>for the VLMC: 243.6 minutes with a standard error of 6.7337834;</li>
<li>for the VLMC with covariate: 286.2 minutes with a standard error of 8.9157448;</li>
<li>410 minutes for the observed time series.</li>
</ul>
<p>The following figure shows the distributions of the times obtained by both models as well as the observed value. The VLMC model with covariate is able to generate longer sequences in the <em>high</em> active power state than the bare VLMC model as the consequence of the sensitivity to the day/night schedule.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lh</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lh_vlmc</span>, <span class="va">lh_covlmc</span><span class="op">)</span>,</span>
<span>  model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"VLMC"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">lh_vlmc</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"COVLMC"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">lh_covlmc</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">lh</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, color <span class="op">=</span> <span class="va">model</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_rug.html" class="external-link">geom_rug</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu">longuest_high</span><span class="op">(</span><span class="va">elec_dts</span><span class="op">)</span>, color <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-longest_time_in_high-1.png" width="100%"></p>
<p>The VLMC with covariate can be used to investigate the effects of changes in those covariates. For instance, if the day time is longer, we expect <em>high</em> power usage to be less frequent. For instance, we simulate one week with a day time from 6:00 to 20:00 as follows.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">elec_cov_long_days</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>day <span class="op">=</span> <span class="op">(</span><span class="va">pc_week_5</span><span class="op">$</span><span class="va">hour</span> <span class="op">&gt;=</span> <span class="fl">6</span> <span class="op">&amp;</span> <span class="va">pc_week_5</span><span class="op">$</span><span class="va">hour</span> <span class="op">&lt;=</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">covlmc_simul_ld</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span>mode <span class="op">=</span> <span class="st">"list"</span>, <span class="fl">100</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">covlmc_simul_ld</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">covlmc_simul_ld</span><span class="op">[[</span><span class="va">k</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate</a></span><span class="op">(</span><span class="va">best_elec_covlmc_aic</span>, nsim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">elec_dts</span><span class="op">)</span>, covariate <span class="op">=</span> <span class="va">elec_cov_long_days</span>, init <span class="op">=</span> <span class="va">elec_dts</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>As expected the distribution of the longest time spend consecutively in <em>high</em> power usage is shifted to lower values when the day length is increased.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lh_covlmc_ld</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">covlmc_simul_ld</span>, <span class="va">longuest_high</span><span class="op">)</span></span>
<span><span class="va">day_time_effect</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lh_covlmc</span>, <span class="va">lh_covlmc_ld</span><span class="op">)</span>,</span>
<span>  `day length` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Short days"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">lh_covlmc</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Long days"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">lh_covlmc_ld</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  check.names <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">day_time_effect</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, color <span class="op">=</span> <span class="va">`day length`</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_rug.html" class="external-link">geom_rug</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-longest_time_in_high_ld-1.png" width="100%"></p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/fabrice-rossi/mixvlmc/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/fabrice-rossi/mixvlmc/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing mixvlmc</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Fabrice Rossi <br><small class="roles"> Author, maintainer, copyright holder </small> <a href="https://orcid.org/0000-0003-4638-1286" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/fabrice-rossi/mixvlmc/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/fabrice-rossi/mixvlmc/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Fabrice Rossi.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
